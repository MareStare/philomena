{
  "wildcard": [
    {
      "philomena": "*",
      "opensearch": {
        "match_all": {}
      }
    },
    {
      "philomena": "artist:*",
      "opensearch": {
        "wildcard": {
          "namespaced_tags.name": "artist:*"
        }
      }
    },
    {
      "philomena": "artist:mare",
      "opensearch": {
        "term": {
          "namespaced_tags.name": "artist:mare"
        }
      }
    }
  ],
  "operators": [
    {
      "philomena": "safe OR pony",
      "opensearch": {
        "bool": {
          "should": [
            {
              "term": {
                "namespaced_tags.name": "safe"
              }
            },
            {
              "term": {
                "namespaced_tags.name": "pony"
              }
            }
          ]
        }
      }
    },
    {
      "philomena": "safe AND pony",
      "opensearch": {
        "bool": {
          "must": [
            {
              "term": {
                "namespaced_tags.name": "safe"
              }
            },
            {
              "term": {
                "namespaced_tags.name": "pony"
              }
            }
          ]
        }
      }
    },
    {
      "philomena": "safe AND (solo OR pony)",
      "opensearch": {
        "bool": {
          "must": [
            {
              "term": {
                "namespaced_tags.name": "safe"
              }
            },
            {
              "bool": {
                "should": [
                  {
                    "term": {
                      "namespaced_tags.name": "solo"
                    }
                  },
                  {
                    "term": {
                      "namespaced_tags.name": "pony"
                    }
                  }
                ]
              }
            }
          ]
        }
      }
    }
  ],
  "authenticated_user": [
    {
      "contexts": [
        {
          "user": ["user"]
        }
      ],
      "philomena": "my:faves",
      "opensearch": {
        "term": {
          "favourited_by_user_ids": 504
        }
      }
    },
    {
      "contexts": [
        {
          "user": ["assistant"]
        }
      ],
      "philomena": "my:faves",
      "opensearch": {
        "term": {
          "favourited_by_user_ids": 505
        }
      }
    },
    {
      "contexts": [
        {
          "user": ["moderator"]
        }
      ],
      "philomena": "my:faves",
      "opensearch": {
        "term": {
          "favourited_by_user_ids": 506
        }
      }
    },
    {
      "contexts": [
        {
          "user": ["admin"]
        }
      ],
      "philomena": "my:faves",
      "opensearch": {
        "term": {
          "favourited_by_user_ids": 507
        }
      }
    },
    {
      "contexts": [
        {
          "user": ["anon"]
        }
      ],
      "philomena": "my:faves",
      "opensearch": {
        "term": {
          "namespaced_tags.name": "my:faves"
        }
      }
    },
    {
      "contexts": [
        {
          "user": ["user", "moderator", "admin", "assistant"],
          "watch": [false]
        }
      ],
      "philomena": "my:watched",
      "opensearch": {
        "bool": {
          "should": [
            {
              "terms": {
                "tag_ids": []
              }
            },
            {
              "match_none": {}
            }
          ],
          "must_not": [
            {
              "match_none": {}
            }
          ]
        }
      }
    },
    {
      "contexts": [
        {
          "user": ["anon"]
        }
      ],
      "philomena": "my:watched",
      "opensearch": {
        "term": {
          "namespaced_tags.name": "my:watched"
        }
      }
    },
    {
      "contexts": [
        {
          "user": ["user", "moderator", "admin", "assistant"],
          "watch": [true]
        }
      ],
      "philomena": "my:watched",
      "opensearch": "Error: Recursive watchlists are not allowed."
    }
  ],
  "system_filter": [
    {
      "contexts": [
        {
          "filter": [false]
        }
      ],
      "philomena": "filter_id:100",
      "opensearch": {
        "bool": {
          "must_not": [
            {
              "terms": {
                "tag_ids": [12, 13]
              }
            },
            {
              "bool": {
                "must": [
                  {
                    "term": {
                      "namespaced_tags.name": "truly"
                    }
                  },
                  {
                    "term": {
                      "namespaced_tags.name": "complex"
                    }
                  }
                ]
              }
            }
          ]
        }
      }
    },
    {
      "contexts": [
        {
          "filter": [true]
        }
      ],
      "philomena": "filter_id:100",
      "opensearch": "Error: Filter queries inside filters are not allowed."
    }
  ],
  "invalid_filters": [
    {
      "contexts": [
        {
          "filter": [true]
        }
      ],
      "philomena": "filter_id:invalid_id",
      "opensearch": "Error: Filter queries inside filters are not allowed."
    },
    {
      "contexts": [
        {
          "filter": [false]
        }
      ],
      "philomena": "filter_id:invalid_id",
      "opensearch": "Error: Invalid filter `invalid_id`."
    },
    {
      "contexts": [
        {
          "filter": [true]
        }
      ],
      "philomena": "filter_id:9999",
      "opensearch": "Error: Filter queries inside filters are not allowed."
    },
    {
      "contexts": [
        {
          "filter": [false]
        }
      ],
      "philomena": "filter_id:9999",
      "opensearch": "Error: Invalid filter `9999`."
    }
  ]
}
